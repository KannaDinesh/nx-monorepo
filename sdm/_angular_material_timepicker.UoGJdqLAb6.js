import*as i from"@angular/core";import{InjectionToken as C,inject as o,ViewContainerRef as E,Injector as S,signal as h,viewChild as F,viewChildren as L,input as d,output as g,booleanAttribute as f,computed as p,effect as _,ElementRef as M,afterNextRender as N,untracked as v,model as P,Renderer2 as q,HostAttributeToken as K}from"@angular/core";import{trigger as B,state as H,style as m,transition as A,group as j,animate as b}from"@angular/animations";import{DateAdapter as I,MAT_DATE_FORMATS as D,MatOption as y,MAT_OPTION_PARENT_COMPONENT as z}from"@angular/material/core";import{Directionality as U}from"@angular/cdk/bidi";import{Overlay as x}from"@angular/cdk/overlay";import{TemplatePortal as Y}from"@angular/cdk/portal";import{_getEventTarget as G}from"@angular/cdk/platform";import{TAB as $,ESCAPE as R,hasModifierKey as w,ENTER as Q,DOWN_ARROW as W,UP_ARROW as X}from"@angular/cdk/keycodes";import{ActiveDescendantKeyManager as Z,_IdGenerator as J}from"@angular/cdk/a11y";import{Validators as ee,NG_VALUE_ACCESSOR as te,NG_VALIDATORS as ie}from"@angular/forms";import{MAT_FORM_FIELD as ae}from"@angular/material/form-field";import{MAT_INPUT_VALUE_ACCESSOR as ne}from"@angular/material/input";import{DOCUMENT as re}from"@angular/common";import{MatIconButton as se}from"@angular/material/button";import{CdkScrollableModule as oe}from"@angular/cdk/scrolling";var le=["panelTemplate"],de=(n,l)=>l.value;function pe(n,l){if(n&1){let e=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-option",3),i.\u0275\u0275listener("onSelectionChange",function(){let a=i.\u0275\u0275restoreView(e).$implicit,r=i.\u0275\u0275nextContext(2);return i.\u0275\u0275resetView(r._selectValue(a.value))}),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()}if(n&2){let e=l.$implicit;i.\u0275\u0275property("value",e.value),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(e.label)}}function ce(n,l){if(n&1&&(i.\u0275\u0275elementStart(0,"div",1),i.\u0275\u0275repeaterCreate(1,pe,2,2,"mat-option",2,de),i.\u0275\u0275elementEnd()),n&2){let e=i.\u0275\u0275nextContext();i.\u0275\u0275property("id",e.panelId)("@panel",void 0),i.\u0275\u0275attribute("aria-label",e.ariaLabel()||null)("aria-labelledby",e._getAriaLabelledby()),i.\u0275\u0275advance(),i.\u0275\u0275repeater(e._timeOptions)}}var ue=[[["","matTimepickerToggleIcon",""]]],me=["[matTimepickerToggleIcon]"];function he(n,l){n&1&&(i.\u0275\u0275namespaceSVG(),i.\u0275\u0275elementStart(0,"svg",1),i.\u0275\u0275element(1,"path",2),i.\u0275\u0275elementEnd())}var _e=/^(\d*\.?\d+)\s*(h|hour|hours|m|min|minute|minutes|s|second|seconds)?$/i,V=new C("MAT_TIMEPICKER_CONFIG");function O(n){let l;if(n===null)return null;if(typeof n=="number")l=n;else{if(n.trim().length===0)return null;let e=n.match(_e),t=e?parseFloat(e[1]):null,a=e?.[2]?.toLowerCase()||null;if(!e||t===null||isNaN(t))return null;a==="h"||a==="hour"||a==="hours"?l=t*3600:a==="m"||a==="min"||a==="minute"||a==="minutes"?l=t*60:l=t}return l}function fe(n,l,e,t,a){let r=[],s=n.compareTime(e,t)<1?e:t;for(;n.sameDate(s,e)&&n.compareTime(s,t)<1&&n.isValid(s);)r.push({value:s,label:n.format(s,l.display.timeOptionLabel)}),s=n.addSeconds(s,a);return r}var ge=new C("MAT_TIMEPICKER_SCROLL_STRATEGY",{providedIn:"root",factory:()=>{let n=o(x);return()=>n.scrollStrategies.reposition()}}),ve=(()=>{class n{_overlay=o(x);_dir=o(U,{optional:!0});_viewContainerRef=o(E);_injector=o(S);_defaultConfig=o(V,{optional:!0});_dateAdapter=o(I,{optional:!0});_dateFormats=o(D,{optional:!0});_scrollStrategyFactory=o(ge);_isOpen=h(!1);_activeDescendant=h(null);_input=h(null);_overlayRef=null;_portal=null;_optionsCacheKey=null;_localeChanges;_onOpenRender=null;_panelTemplate=F.required("panelTemplate");_timeOptions=[];_options=L(y);_keyManager=new Z(this._options,this._injector).withHomeAndEnd(!0).withPageUpDown(!0).withVerticalOrientation(!0);interval=d(O(this._defaultConfig?.interval||null),{transform:O});options=d(null);isOpen=this._isOpen.asReadonly();selected=g();opened=g();closed=g();activeDescendant=this._activeDescendant.asReadonly();panelId=o(J).getId("mat-timepicker-panel-");disableRipple=d(this._defaultConfig?.disableRipple??!1,{transform:f});ariaLabel=d(null,{alias:"aria-label"});ariaLabelledby=d(null,{alias:"aria-labelledby"});disabled=p(()=>!!this._input()?.disabled());constructor(){o(M).nativeElement.setAttribute("mat-timepicker-panel-id",this.panelId),this._handleLocaleChanges(),this._handleInputStateChanges(),this._keyManager.change.subscribe(()=>this._activeDescendant.set(this._keyManager.activeItem?.id||null))}open(){let e=this._input();if(!e||(e.focus(),this._isOpen()))return;this._isOpen.set(!0),this._generateOptions();let t=this._getOverlayRef();t.updateSize({width:e.getOverlayOrigin().nativeElement.offsetWidth}),this._portal??=new Y(this._panelTemplate(),this._viewContainerRef),t.attach(this._portal),this._onOpenRender?.destroy(),this._onOpenRender=N(()=>{let a=this._options();this._syncSelectedState(e.value(),a,a[0]),this._onOpenRender=null},{injector:this._injector}),this.opened.emit()}close(){this._isOpen()&&(this._isOpen.set(!1),this._overlayRef?.detach(),this.closed.emit())}registerInput(e){let t=this._input();this._input.set(e)}ngOnDestroy(){this._keyManager.destroy(),this._localeChanges.unsubscribe(),this._onOpenRender?.destroy(),this._overlayRef?.dispose()}_selectValue(e){this.close(),this.selected.emit({value:e,source:this}),this._input()?.focus()}_getAriaLabelledby(){return this.ariaLabel()?null:this.ariaLabelledby()||this._input()?._getLabelId()||null}_getOverlayRef(){if(this._overlayRef)return this._overlayRef;let e=this._overlay.position().flexibleConnectedTo(this._input().getOverlayOrigin()).withFlexibleDimensions(!1).withPush(!1).withTransformOriginOn(".mat-timepicker-panel").withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-timepicker-above"}]);return this._overlayRef=this._overlay.create({positionStrategy:e,scrollStrategy:this._scrollStrategyFactory(),direction:this._dir||"ltr",hasBackdrop:!1}),this._overlayRef.keydownEvents().subscribe(t=>{this._handleKeydown(t)}),this._overlayRef.outsidePointerEvents().subscribe(t=>{let a=G(t),r=this._input()?.getOverlayOrigin().nativeElement;a&&r&&a!==r&&!r.contains(a)&&this.close()}),this._overlayRef}_generateOptions(){let e=this.interval()??1800,t=this.options();if(t!==null)this._timeOptions=t;else{let a=this._input(),r=this._dateAdapter,s=this._dateFormats.display.timeInput,c=a?.min()||r.setTime(r.today(),0,0,0),u=a?.max()||r.setTime(r.today(),23,59,0),k=e+"/"+r.format(c,s)+"/"+r.format(u,s);k!==this._optionsCacheKey&&(this._optionsCacheKey=k,this._timeOptions=fe(r,this._dateFormats,c,u,e))}}_syncSelectedState(e,t,a){let r=!1;for(let s of t)e&&this._dateAdapter.sameTime(s.value,e)?(s.select(!1),T(s,"center"),v(()=>this._keyManager.setActiveItem(s)),r=!0):s.deselect(!1);r||(a?(v(()=>this._keyManager.setActiveItem(a)),T(a,"center")):v(()=>this._keyManager.setActiveItem(-1)))}_handleKeydown(e){let t=e.keyCode;if(t===$)this.close();else if(t===R&&!w(e))e.preventDefault(),this.close();else if(t===Q)e.preventDefault(),this._keyManager.activeItem?this._selectValue(this._keyManager.activeItem.value):this.close();else{let a=this._keyManager.activeItem;this._keyManager.onKeydown(e);let r=this._keyManager.activeItem;r&&r!==a&&T(r,"nearest")}}_handleLocaleChanges(){this._localeChanges=this._dateAdapter.localeChanges.subscribe(()=>{this._optionsCacheKey=null,this.isOpen()&&this._generateOptions()})}_handleInputStateChanges(){_(()=>{let e=this._input(),t=this._options();this._isOpen()&&e&&this._syncSelectedState(e.value(),t,null)})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=i.\u0275\u0275defineComponent({type:n,selectors:[["mat-timepicker"]],viewQuery:function(t,a){t&1&&(i.\u0275\u0275viewQuerySignal(a._panelTemplate,le,5),i.\u0275\u0275viewQuerySignal(a._options,y,5)),t&2&&i.\u0275\u0275queryAdvance(2)},inputs:{interval:[1,"interval"],options:[1,"options"],disableRipple:[1,"disableRipple"],ariaLabel:[1,"aria-label","ariaLabel"],ariaLabelledby:[1,"aria-labelledby","ariaLabelledby"]},outputs:{selected:"selected",opened:"opened",closed:"closed"},exportAs:["matTimepicker"],features:[i.\u0275\u0275ProvidersFeature([{provide:z,useExisting:n}])],decls:2,vars:0,consts:[["panelTemplate",""],["role","listbox",1,"mat-timepicker-panel",3,"id"],[3,"value"],[3,"onSelectionChange","value"]],template:function(t,a){t&1&&i.\u0275\u0275template(0,ce,3,4,"ng-template",null,0,i.\u0275\u0275templateRefExtractor)},dependencies:[y],styles:["mat-timepicker{display:none}.mat-timepicker-panel{width:100%;max-height:256px;transform-origin:center top;overflow:auto;padding:8px 0;box-sizing:border-box;border-bottom-left-radius:var(--mat-timepicker-container-shape, var(--mat-sys-corner-extra-small));border-bottom-right-radius:var(--mat-timepicker-container-shape, var(--mat-sys-corner-extra-small));box-shadow:var(--mat-timepicker-container-elevation-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12));background-color:var(--mat-timepicker-container-background-color, var(--mat-sys-surface-container))}@media(forced-colors: active){.mat-timepicker-panel{outline:solid 1px}}.mat-timepicker-above .mat-timepicker-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mat-timepicker-container-shape, var(--mat-sys-corner-extra-small));border-top-right-radius:var(--mat-timepicker-container-shape, var(--mat-sys-corner-extra-small))}.mat-timepicker-input[readonly]{cursor:pointer}@media(forced-colors: active){.mat-timepicker-toggle-default-icon{color:CanvasText}}"],encapsulation:2,data:{animation:[B("panel",[H("void",m({opacity:0,transform:"scaleY(0.8)"})),A(":enter",[j([b("0.03s linear",m({opacity:1})),b("0.12s cubic-bezier(0, 0, 0.2, 1)",m({transform:"scaleY(1)"}))])]),A(":leave",[b("0.075s linear",m({opacity:0}))])])]},changeDetection:0})}return n})();function T(n,l){n._getHostElement().scrollIntoView({block:l,inline:l})}var Ke=(()=>{class n{_elementRef=o(M);_document=o(re);_dateAdapter=o(I,{optional:!0});_dateFormats=o(D,{optional:!0});_formField=o(ae,{optional:!0});_onChange;_onTouched;_validatorOnChange;_cleanupClick;_accessorDisabled=h(!1);_localeSubscription;_timepickerSubscription;_validator;_lastValueValid=!0;_lastValidDate=null;_ariaActiveDescendant=p(()=>{let e=this.timepicker(),t=e.isOpen(),a=e.activeDescendant();return t&&a?a:null});_ariaExpanded=p(()=>this.timepicker().isOpen()+"");_ariaControls=p(()=>{let e=this.timepicker();return e.isOpen()?e.panelId:null});value=P(null);timepicker=d.required({alias:"matTimepicker"});min=d(null,{alias:"matTimepickerMin",transform:e=>this._transformDateInput(e)});max=d(null,{alias:"matTimepickerMax",transform:e=>this._transformDateInput(e)});disabled=p(()=>this.disabledInput()||this._accessorDisabled());disabledInput=d(!1,{transform:f,alias:"disabled"});constructor(){let e=o(q);this._validator=this._getValidator(),this._respondToValueChanges(),this._respondToMinMaxChanges(),this._registerTimepicker(),this._localeSubscription=this._dateAdapter.localeChanges.subscribe(()=>{this._hasFocus()||this._formatValue(this.value())}),this._cleanupClick=e.listen(this.getOverlayOrigin().nativeElement,"click",this._handleClick)}writeValue(e){let t=this._dateAdapter.deserialize(e);this.value.set(this._dateAdapter.getValidDateOrNull(t))}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._accessorDisabled.set(e)}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._validatorOnChange=e}getOverlayOrigin(){return this._formField?.getConnectedOverlayOrigin()||this._elementRef}focus(){this._elementRef.nativeElement.focus()}ngOnDestroy(){this._cleanupClick(),this._timepickerSubscription?.unsubscribe(),this._localeSubscription.unsubscribe()}_getLabelId(){return this._formField?.getLabelId()||null}_handleClick=()=>{this.disabled()||this.timepicker().open()};_handleInput(e){let t=this.value(),a=this._dateAdapter.parseTime(e,this._dateFormats.parse.timeInput),r=!this._dateAdapter.sameTime(a,t);!a||r||e&&!t?this._assignUserSelection(a,!0):this._validatorOnChange?.()}_handleBlur(){let e=this.value();e&&this._isValid(e)&&this._formatValue(e),this.timepicker().isOpen()||this._onTouched?.()}_handleKeydown(e){this.timepicker().isOpen()||this.disabled()||(e.keyCode===R&&!w(e)&&this.value()!==null?(e.preventDefault(),this.value.set(null),this._formatValue(null)):(e.keyCode===W||e.keyCode===X)&&(e.preventDefault(),this.timepicker().open()))}_respondToValueChanges(){_(()=>{let e=this._dateAdapter.deserialize(this.value()),t=this._lastValueValid;this._lastValueValid=this._isValid(e),this._hasFocus()||this._formatValue(e),e&&this._lastValueValid&&(this._lastValidDate=e),t!==this._lastValueValid&&this._validatorOnChange?.()})}_registerTimepicker(){_(()=>{let e=this.timepicker();e.registerInput(this),e.closed.subscribe(()=>this._onTouched?.()),e.selected.subscribe(({value:t})=>{this._dateAdapter.sameTime(t,this.value())||(this._assignUserSelection(t,!0),this._formatValue(t))})})}_respondToMinMaxChanges(){_(()=>{this.min(),this.max(),this._validatorOnChange?.()})}_assignUserSelection(e,t){if(e==null||!this._isValid(e))this.value.set(e);else{let a=this._dateAdapter,r=a.getValidDateOrNull(this._lastValidDate||this.value()),s=a.getHours(e),c=a.getMinutes(e),u=a.getSeconds(e);this.value.set(r?a.setTime(r,s,c,u):e)}t&&this._onChange?.(this.value())}_formatValue(e){e=this._dateAdapter.getValidDateOrNull(e),this._elementRef.nativeElement.value=e==null?"":this._dateAdapter.format(e,this._dateFormats.display.timeInput)}_isValid(e){return!e||this._dateAdapter.isValid(e)}_transformDateInput(e){let t=typeof e=="string"?this._dateAdapter.parseTime(e,this._dateFormats.parse.timeInput):this._dateAdapter.deserialize(e);return t&&this._dateAdapter.isValid(t)?t:null}_hasFocus(){return this._document.activeElement===this._elementRef.nativeElement}_getValidator(){return ee.compose([()=>this._lastValueValid?null:{matTimepickerParse:{text:this._elementRef.nativeElement.value}},e=>{let t=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e.value)),a=this.min();return!a||!t||this._dateAdapter.compareTime(a,t)<=0?null:{matTimepickerMin:{min:a,actual:t}}},e=>{let t=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e.value)),a=this.max();return!a||!t||this._dateAdapter.compareTime(a,t)>=0?null:{matTimepickerMax:{max:a,actual:t}}}])}static \u0275fac=function(t){return new(t||n)};static \u0275dir=i.\u0275\u0275defineDirective({type:n,selectors:[["input","matTimepicker",""]],hostAttrs:["role","combobox","type","text","aria-haspopup","listbox",1,"mat-timepicker-input"],hostVars:5,hostBindings:function(t,a){if(t&1&&i.\u0275\u0275listener("blur",function(){return a._handleBlur()})("input",function(s){return a._handleInput(s.target.value)})("keydown",function(s){return a._handleKeydown(s)}),t&2){let r;i.\u0275\u0275hostProperty("disabled",a.disabled()),i.\u0275\u0275attribute("aria-activedescendant",a._ariaActiveDescendant())("aria-expanded",a._ariaExpanded())("aria-controls",a._ariaControls())("mat-timepicker-id",(r=a.timepicker())==null?null:r.panelId)}},inputs:{value:[1,"value"],timepicker:[1,"matTimepicker","timepicker"],min:[1,"matTimepickerMin","min"],max:[1,"matTimepickerMax","max"],disabledInput:[1,"disabled","disabledInput"]},outputs:{value:"valueChange"},exportAs:["matTimepickerInput"],features:[i.\u0275\u0275ProvidersFeature([{provide:te,useExisting:n,multi:!0},{provide:ie,useExisting:n,multi:!0},{provide:ne,useExisting:n}])]})}return n})(),be=(()=>{class n{_defaultConfig=o(V,{optional:!0});_defaultTabIndex=(()=>{let e=o(new K("tabindex"),{optional:!0}),t=Number(e);return isNaN(t)?null:t})();_isDisabled=p(()=>{let e=this.timepicker();return this.disabled()||e.disabled()});timepicker=d.required({alias:"for"});ariaLabel=d(void 0,{alias:"aria-label"});disabled=d(!1,{transform:f,alias:"disabled"});tabIndex=d(this._defaultTabIndex);disableRipple=d(this._defaultConfig?.disableRipple??!1,{transform:f});_open(e){this.timepicker()&&!this._isDisabled()&&(this.timepicker().open(),e.stopPropagation())}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=i.\u0275\u0275defineComponent({type:n,selectors:[["mat-timepicker-toggle"]],hostAttrs:[1,"mat-timepicker-toggle"],hostVars:1,hostBindings:function(t,a){t&1&&i.\u0275\u0275listener("click",function(s){return a._open(s)}),t&2&&i.\u0275\u0275attribute("tabindex",null)},inputs:{timepicker:[1,"for","timepicker"],ariaLabel:[1,"aria-label","ariaLabel"],disabled:[1,"disabled"],tabIndex:[1,"tabIndex"],disableRipple:[1,"disableRipple"]},exportAs:["matTimepickerToggle"],ngContentSelectors:me,decls:3,vars:5,consts:[["mat-icon-button","","type","button","aria-haspopup","listbox",3,"disabled","disableRipple"],["height","24px","width","24px","viewBox","0 -960 960 960","fill","currentColor","focusable","false","aria-hidden","true",1,"mat-timepicker-toggle-default-icon"],["d","m612-292 56-56-148-148v-184h-80v216l172 172ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-400Zm0 320q133 0 226.5-93.5T800-480q0-133-93.5-226.5T480-800q-133 0-226.5 93.5T160-480q0 133 93.5 226.5T480-160Z"]],template:function(t,a){t&1&&(i.\u0275\u0275projectionDef(ue),i.\u0275\u0275elementStart(0,"button",0),i.\u0275\u0275projection(1,0,null,he,2,0),i.\u0275\u0275elementEnd()),t&2&&(i.\u0275\u0275property("disabled",a._isDisabled())("disableRipple",a.disableRipple()),i.\u0275\u0275attribute("aria-label",a.ariaLabel())("aria-expanded",a.timepicker().isOpen())("tabindex",a._isDisabled()?-1:a.tabIndex()))},dependencies:[se],encapsulation:2,changeDetection:0})}return n})(),Be=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=i.\u0275\u0275defineNgModule({type:n});static \u0275inj=i.\u0275\u0275defineInjector({imports:[ve,be,oe]})}return n})();export{V as MAT_TIMEPICKER_CONFIG,ge as MAT_TIMEPICKER_SCROLL_STRATEGY,ve as MatTimepicker,Ke as MatTimepickerInput,Be as MatTimepickerModule,be as MatTimepickerToggle};
